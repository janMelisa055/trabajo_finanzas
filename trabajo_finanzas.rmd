---
title: "Trabajo Finanzas I"
author: "Melissa, Lucas, Amanda, Exequiel"
date: "2023-03-30"
output: pdf_document
---

\newpage

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, comment = NA)
setwd("C:/Users/oienh/Documents/R_UNIVERSITY_PROJECTS/5th_Semester/trabajo_finanzas")

formato <- function(x) {
    format(round(x, 2), big.mark = " ", scientific = FALSE,
    decimal.mark = ",")
}
# Formato para añadir separadores de miles, coma decimal, y
# dos puntos decimales.
```

## Instrucciones: Elaborar informe de análisis financiero:
## Incluir:
## - Análisis estático comparativo (últimos dos balances de cierre DUDAS).
## - Análisis de liquidez (ratios HECHO).
## - Ratios financieros en genreral DUDAS.
## - Ratios económicos (margen, rendimiento, rentabilidad DUDAS).
## - Introducción.
## - Marco conceptual.
## - Análisis.
## - Conclusiones.

# Empresa escogida: Amazon

# Introducción

[ESCRIBIR INTRODUCCIÓN]

```{r}
library(readxl)

estado_de_resultado <- read_excel(
    "estado_de_resultados.xlsx",  range = "A1:C35")
balance <- read_excel("balance.xlsx",  range = "A1:C49")
estado_de_resultado <- estado_de_resultado[-1, ]
balance <- balance[-1, ]
# Se extrajo los datos de los archivos. Fuente: "investing.com".
```

# Capital trabajo neto

```{r}
capital_trabajo_neto_2022 <- as.numeric(balance[1,
    2]) - as.numeric(balance[21, 2])
capital_trabajo_neto_2021 <- as.numeric(balance[1,
    3]) - as.numeric(balance[21, 3])
# Fórmula: capital trabajo neto = activos corrientes - pasivos corrientes.

cat(" El capital de trabajo neto fue de USD",
    formato(capital_trabajo_neto_2021),
    "M en el año 2021", "\n",
    "mientras que en 2022 fue de USD",
    formato(capital_trabajo_neto_2022), "M.", "\n",
    "La diferencia es de USD",
    capital_trabajo_neto_2022 - capital_trabajo_neto_2021, "M.")
```

# Liquidez

```{r}
liquidez_2022 <- as.numeric(balance[1, 2]) / as.numeric(balance[21, 2])
liquidez_2021 <- as.numeric(balance[1, 3]) / as.numeric(balance[21, 3])
# Fórmula: liquidez = activos corrientes / pasivos corrientes.

cat(" La liquidez del año 2021 fue de un ratio de",
    formato(liquidez_2021 * 100), "%, mientras que", "\n",
    "en el año 2022 fue de un ratio de", formato(liquidez_2022*100), "%.", "\n",
    "La diferencia fue de", liquidez_2022 - liquidez_2021, "%.")
```

# Ratios económicos

## Margen

```{r}

margen <- as.numeric(estado_de_resultado[4,
    2]) / as.numeric(estado_de_resultado[4, 3]) - 1

cat(" El margen bruto del 2022 ha aumentado en un", formato(margen * 100),
    "% en comparación al año 2021.")

```

## Rendimiento

```{r}

```
Rentabilidad bruta = Resultado bruto / Ingresos
Rentabilidad operacional = Resultado operacional / Ingresos
Rentabilidad neta = Resultado neto / Ingresos
## Rentabilidad

### Rentabilidad Bruta
```{r}
rentabilidad_bruta_2022 <- (as.numeric(estado_de_resultado[1,
    2]) - as.numeric(estado_de_resultado[6,
    2])) / as.numeric(estado_de_resultado[1, 2])

rentabilidad_bruta_2021 <- (as.numeric(estado_de_resultado[1,
    3]) - as.numeric(estado_de_resultado[6,
    3])) / as.numeric(estado_de_resultado[1, 3])

# (Ingresos - Total gastos de operación) / Ingresos

cat(" La rentabilidad bruta del año 2021 fue de",
    formato(rentabilidad_bruta_2021 * 100), "%", "\n",
    "mientras que en el año 2022 fue de",
    formato(rentabilidad_bruta_2022 * 100), "%.", "\n",
    "La diferencia es de",
    formato(rentabilidad_bruta_2022 * 100 - rentabilidad_bruta_2021 * 100), "%.")
```
### Rentabilidad Operacional

```{r}

rentabilidad_operacional_2022 <- (as.numeric(estado_de_resultado[1,
    2]) - as.numeric(estado_de_resultado[6,
    2]) - as.numeric(estado_de_resultado[7,
    2])) / as.numeric(estado_de_resultado[1, 2])

rentabilidad_operacional_2021 <- (as.numeric(estado_de_resultado[1,
    3]) - as.numeric(estado_de_resultado[6,
    3]) - as.numeric(estado_de_resultado[7,
    3])) / as.numeric(estado_de_resultado[1, 3])

# (Ingresos - Total gastos de operación - Venta y adm. total) / Ingresos = Rentabilidad Operacional.
# (Ingresos - Total gastos de operación - Venta y adm. total) = Resultado Operacional.

cat(" La rentabilidad operacional del año 2021 fue de",
    formato(rentabilidad_operacional_2021 * 100), "%", "\n",
    "mientras que en el año 2022 fue de",
    formato(rentabilidad_operacional_2022 * 100), "%.", "\n",
    "La diferencia es de",
    formato(rentabilidad_operacional_2022 * 100 - rentabilidad_operacional_2021 * 100),
    "%.")

```
### Rentabilidad Neta

```{r}
rentabilidad_neta_2022 <- as.numeric(estado_de_resultado[25,
    2]) / as.numeric(estado_de_resultado[1, 2])

rentabilidad_neta_2021 <- as.numeric(estado_de_resultado[25,
    3]) / as.numeric(estado_de_resultado[1, 3])

cat(" La rentabilidad neta del año 2021 fue de",
    formato(rentabilidad_neta_2021 * 100), "%", "\n",
    "mientras que en el año 2022 fue de",
    formato(rentabilidad_neta_2022 * 100), "%.", "\n",
    "La diferencia es de",
    formato(rentabilidad_neta_2022 * 100 - rentabilidad_neta_2021 * 100), "%.")

```

rentabilidad_neta
*
Cosas que pueden ser útiles:

Relativo porcentual

efectivo y equivalente
cuentas por cobrar
inventarios
activo fijo
otros activos largo plazo
total
banco corto plazo
proveedores
banco largo plazo
capital
resultado acumulado
total


total <- "la suma de todo lol"
relativo_porcentual <- apply("", function(x) x / total)
activo_corriente <- sum()
pasivo_corriente <- sum()
capital_trabajo_neto <- activo_corriente - pasivo_corriente
liquidez <- activo_corriente / pasivo_corriente
prueba_acida <- (activo_corriente - inventarios) / pasivo_corriente
liquidez_inmediata <- efectivo y equivalente / pasivo_corriente
solvencia <- pasivos / patrimonio
endeudamiento <- (pasivos - patrimonio) / patrimonio





