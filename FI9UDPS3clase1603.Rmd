---
title: "FI9UDP1603"
author: "Guillermo Yañez"
date: "2023-03-16"
output:
  html_document:
    df_print: paged
---

```{r setup, echo=TRUE}
knitr::opts_chunk$set(echo = TRUE)
options(scipen = 999)
```


Vamos a poner el directorio de trabajo correcto:

```{r}
setwd("C:/Users/oienh/Documents/R_UNIVERSITY_PROJECTS/5th_Semester")
```

Comencemos con análisis financiero:

Para ello vamos a importar un archivo Excel, necesitaremos install.packages('readxl')

```{r}
library(readxl)

balance <- read_xlsx("Ejercicio2103.xlsx", sheet = "Balance",
range = "A1:D6", col_names = TRUE)

```

Sumemos las columnas:

```{r}

suma <- apply(balance[, c(2, 4)], 2, sum)

balance[6, 2] <- suma[1]
balance[6, 4] <- suma[2]
# Añadí "Total" al balance.
balance[6, 1] <- "Total"
balance[6, 3] <- "Total"

```

Armemos el estado de resultados:

```{r}

eerr <- read_xlsx("Ejercicio2103.xlsx", sheet = "EERR", range = "A1:B5",
col_names = TRUE)

```

Ahora podemos comenzar a analizar

Vamos a hacer un análisis estático del balance: (vamos a ver el peso relativo de las partidas)

```{r}

balance2 <- balance

total <- as.numeric(balance2[6, 2])
relativo <- apply(balance2[, c(2, 4)], 2, function(x) x / total)

balance2[, 2] <- relativo[, 1]
balance2[, 4] <- relativo[, 2]

```

## Veamos algunos ratios financieros

- Ratios: Relación entre una variable y otra. Se comporta como un índice (no tiene unidad de medida sino que es interpretativo)
- Proporciones: Lo que hicimos en análisis estático
- Tasas: % Relativo de una variable respecto a otra o tasa de variación temporal.

### Liquidez

Capital de trabajo neto:

Activo corriente - pasivo corriente
La diferencia entre el activo corriente y el pasivo corriente es Capital de Trabajo Neto
```{r}

activo_corriente <- sum(balance[c(1:3), 2])
pasivo_corriente <-  sum(balance[c(1:2), 4])
kapital_trabajo_neto <- activo_corriente - pasivo_corriente

```

Vemos que es positivo.

### Liquidez corriente:

liquidez = activo_corriente / pasivo_corriente

```{r}
liquidez <- activo_corriente / pasivo_corriente
```
Por un peso de deuda es 1.82 veces de activo corriente.
 
```{r}
prueba_acida <- (activo_corriente - balance[3, 2]) / pasivo_corriente
# balance[3, 2]: inventarios
prueba_acida <- as.numeric(prueba_acida)
```

```{r}
liq_inm <- balance[1, 2] / pasivo_corriente
liq_inm <- as.numeric(liq_inm)
```
Solvencia (largo plazo)

```{r}
solvencia <- total / (total - sum(balance[c(4, 5), 4])) # pasivos / patrimonio
```

Endeudamiento

```{r}
endeudamiento <- (total - sum(balance[c(4, 5), 4])) / sum(balance[c(4, 5), 4])
```

Márgenes:

Dos periodos de tiempo, comparar.
